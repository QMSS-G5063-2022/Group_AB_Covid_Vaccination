knitr::opts_chunk$set(echo = TRUE)
library("dplyr")
library("plotly")
# read the data file
df = read.csv('owid-covid-data.csv')
df <- df %>%
filter(!is.na(people_vaccinated), !is.na(people_fully_vaccinated), !is.na(continent), !is.na(gdp_per_capita))
# gdp_per_capita, population, people_fully_vaccinated_per_hundred
df1 <- df %>%
group_by(location) %>%
summarise(gdp_per_capita = min(gdp_per_capita), population = max(population), people_fully_vaccinated_per_hundred = max(people_fully_vaccinated_per_hundred))
df2 <- df1 %>%
arrange(desc(gdp_per_capita)) %>%
head(20)
df2 %>%
ggplot(aes(x = reorder(location, -gdp_per_capita), y = people_fully_vaccinated_per_hundred, fill = location)) +
geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust=1)) +
ggtitle("Vaccination Rate of The Top 20 Richest Countries") +
xlab("Country") + ylab("People Fully Vaccinated Per Hundred") +
geom_hline(yintercept = mean(df2$people_fully_vaccinated_per_hundred), color="blue") +
theme(legend.position = "none")
# This plot shows the vaccination coverage of top 20 richest countries.
# The country(x axis) is ordered by gdp_per_capita from highest to lowest (Qatar is the richest country)
# The blue line is the average "People Fully Vaccinated Per Hundred" of those 20 countries
# Takeaways:
#
library("dplyr")
library("plotly")
# read the data file
df = read.csv('owid-covid-data.csv')
df <- df %>%
filter(!is.na(people_vaccinated), !is.na(people_fully_vaccinated), !is.na(continent), !is.na(gdp_per_capita))
# gdp_per_capita, population, people_fully_vaccinated_per_hundred
df1 <- df %>%
group_by(location) %>%
summarise(gdp_per_capita = min(gdp_per_capita), population = max(population), people_fully_vaccinated_per_hundred = max(people_fully_vaccinated_per_hundred))
df2 <- df1 %>%
arrange(desc(gdp_per_capita)) %>%
head(20)
df2 %>%
ggplot(aes(x = reorder(location, -gdp_per_capita), y = people_fully_vaccinated_per_hundred, fill = location)) +
geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust=1)) +
ggtitle("Vaccination Rate of The Top 20 Countries with Highest GDP Per Capita") +
xlab("Country") + ylab("People Fully Vaccinated Per Hundred") +
geom_hline(yintercept = mean(df2$people_fully_vaccinated_per_hundred), color="blue") +
theme(legend.position = "none")
# This plot shows the vaccination coverage of top 20 countries with highest GDP per capita.
# The country(x axis) is ordered by gdp_per_capita from highest to lowest (Qatar is the richest country)
# The blue line is the average "People Fully Vaccinated Per Hundred" of those 20 countries
# Takeaways:
# - Countries with higher GDP per capita does correlate with vaccination coverage
# - Some countries like Luxembourg have high GDP per capia but have low vaccination coverage.
df_content = read.csv('owid-covid-data.csv')
df_content <- df_content %>%
filter(!is.na(people_vaccinated), !is.na(people_fully_vaccinated), !is.na(gdp_per_capita))
df_content1 <- df_content %>%
group_by(continent) %>%
summarise(gdp_per_capita = mean(gdp_per_capita), people_fully_vaccinated_per_hundred = mean(people_fully_vaccinated_per_hundred)) %>%
filter(continent != '')
df_content1 %>%
ggplot(aes(x = reorder(continent, -gdp_per_capita), y = people_fully_vaccinated_per_hundred, fill = continent)) +
geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust=1)) +
ggtitle("Vaccination Rate over 6 Continents") +
xlab("Continent") + ylab("People Fully Vaccinated Per Hundred") +
geom_hline(yintercept = mean(df_content1$people_fully_vaccinated_per_hundred), color="blue") +
theme(legend.position = "none")
# This plot shows the vaccination rate over 6 continents (How region affects vaccination coverage).
# Takeaways:
# - Africa has lowest GDP and lowest percentage of receiving vaccinations.
# - For other 4 Continents, Vaccination rate are close.
